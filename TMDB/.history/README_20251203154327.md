# TMDB 電影票房預測專案

使用 Taskmaster 方法系統化開發的機器學習專案，預測電影票房收入。

## 專案結構

```
.
├── train.csv                 # 訓練資料
├── test.csv                  # 測試資料
├── sample_submission.csv     # 提交範例
├── main.py                   # 主程式
├── task.md                   # 任務規劃文件
├── report.md                 # 專案報告
├── README.md                 # 本文件
└── submission.csv            # 生成的預測結果
```

## 環境需求

### Python 版本
- Python 3.8+

### 必要套件
```bash
pip install pandas numpy scikit-learn xgboost lightgbm catboost matplotlib seaborn
```

或使用 requirements.txt:
```bash
pip install -r requirements.txt
```

## 快速開始

### 1. 安裝依賴
```bash
pip install pandas numpy scikit-learn xgboost lightgbm catboost matplotlib seaborn
```

### 2. 執行主程式
```bash
python main.py
```

程式會自動執行以下步驟：
1. 載入資料
2. 探索性資料分析
3. 特徵工程
4. 訓練多個模型（Random Forest, XGBoost, LightGBM, CatBoost）
5. 模型融合（Voting）
6. 生成預測結果

### 3. 查看結果
執行完成後會生成 `submission.csv` 檔案，包含測試集的預測結果。

## 專案特色

### 1. Taskmaster 方法
採用系統化的任務分解方法，將專案分為多個階段：
- 問題定義與資料理解
- 探索性資料分析
- 資料預處理
- 模型建立與訓練
- 模型融合
- 評估與優化

### 2. 完整的特徵工程
- 時間特徵提取（年、月、日、季度）
- JSON 欄位解析（genres, cast, crew, keywords）
- 衍生特徵創建（budget_popularity_ratio, budget_per_minute）
- 文本長度特徵
- 類別特徵編碼

### 3. 多模型融合
實作了多種模型融合策略：
- **Simple Voting**: 簡單平均
- **Weighted Voting**: 加權平均
- 支援 Random Forest, XGBoost, LightGBM, CatBoost

### 4. 完整的文件記錄
- `task.md`: 詳細的任務規劃
- `report.md`: 完整的專案報告，包含：
  - 題目選定
  - 資料分析及處理
  - 模型架構與介紹
  - Voting 作法討論
  - 最終結果和結論

## 主要功能

### TMDBPredictor 類別

```python
predictor = TMDBPredictor()

# 載入資料
predictor.load_data()

# 探索性資料分析
predictor.explore_data()

# 準備特徵
predictor.prepare_features()

# 訓練模型
predictor.train_models()

# 模型融合
predictor.ensemble_voting()

# 生成預測
submission = predictor.predict_and_submit()
```

## 模型說明

### 1. Random Forest
- 樹的數量: 100
- 最大深度: 15
- 最小分裂樣本數: 5

### 2. XGBoost
- 迭代次數: 100
- 最大深度: 6
- 學習率: 0.1

### 3. LightGBM
- 迭代次數: 100
- 最大深度: 6
- 學習率: 0.1

### 4. CatBoost
- 迭代次數: 100
- 深度: 6
- 學習率: 0.1

## 評估指標

- **RMSE** (Root Mean Squared Error): 主要評估指標
- **MAE** (Mean Absolute Error): 次要評估指標
- **R²** (R-squared): 模型解釋力

## 特徵列表

### 數值特徵
- budget: 電影預算
- popularity: 人氣度
- runtime: 電影時長

### 時間特徵
- release_year: 上映年份
- release_month: 上映月份
- release_day: 上映日期
- release_quarter: 上映季度

### 計數特徵
- genres_count: 類型數量
- cast_count: 演員數量
- crew_count: 工作人員數量
- keywords_count: 關鍵字數量
- production_companies_count: 製作公司數量

### 衍生特徵
- has_collection: 是否屬於系列電影
- title_length: 標題長度
- overview_length: 簡介長度
- tagline_length: 標語長度
- budget_popularity_ratio: 預算人氣比
- budget_per_minute: 每分鐘預算

### 類別特徵
- original_language: 原始語言
- status: 狀態
- top_genre: 主要類型

## 進階使用

### 自訂模型參數

```python
predictor = TMDBPredictor()
predictor.load_data()
predictor.prepare_features()

# 自訂 XGBoost 參數
from xgboost import XGBRegressor
custom_xgb = XGBRegressor(
    n_estimators=200,
    max_depth=8,
    learning_rate=0.05
)
custom_xgb.fit(predictor.X_train, predictor.y_train)
```

### 使用不同的融合策略

```python
# 使用特定模型進行預測
submission = predictor.predict_and_submit(model_name='xgb')  # 只使用 XGBoost
submission = predictor.predict_and_submit(model_name='voting')  # 使用簡單 Voting
```

## 常見問題

### Q1: 執行時出現記憶體不足
A: 可以減少模型的 n_estimators 參數，或使用較小的 max_depth。

### Q2: 如何提升預測準確度？
A: 可以嘗試：
- 更細緻的特徵工程
- 超參數調優
- 增加更多外部資料
- 使用更複雜的融合策略（如 Stacking）

### Q3: 訓練時間太長
A: 可以：
- 減少模型數量
- 降低 n_estimators
- 使用較小的訓練集進行快速實驗

## 參考資料

- [Kaggle TMDB Dataset](https://www.kaggle.com/datasets/tmdb/tmdb-movie-metadata)
- [Scikit-learn Documentation](https://scikit-learn.org/)
- [XGBoost Documentation](https://xgboost.readthedocs.io/)
- [LightGBM Documentation](https://lightgbm.readthedocs.io/)
- [CatBoost Documentation](https://catboost.ai/docs/)

## 授權

MIT License

## 作者

TMDB Movie Revenue Prediction Project

## 更新日誌

- 2025-12-03: 初始版本發布
  - 實作基本特徵工程
  - 實作多模型訓練
  - 實作 Voting 融合策略
  - 完成文件撰寫
