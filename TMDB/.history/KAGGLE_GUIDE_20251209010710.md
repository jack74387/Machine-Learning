# Kaggle Notebook ä½¿ç”¨æŒ‡å—

## å¿«é€Ÿé–‹å§‹

### 1. åœ¨ Kaggle ä¸Šå‰µå»ºæ–°çš„ Notebook

1. å‰å¾€ [TMDB Box Office Prediction](https://www.kaggle.com/competitions/tmdb-box-office-prediction)
2. é»æ“Š "Code" â†’ "New Notebook"
3. é¸æ“‡ Python ç’°å¢ƒ

### 2. è¤‡è£½ç¨‹å¼ç¢¼

å°‡ `main-2.py` çš„å…§å®¹è¤‡è£½åˆ° Kaggle Notebook ä¸­ã€‚

### 3. åŸ·è¡Œç¨‹å¼

ç›´æ¥åŸ·è¡Œæ•´å€‹ Notebookï¼Œç¨‹å¼æœƒè‡ªå‹•ï¼š
- è¼‰å…¥è³‡æ–™ï¼ˆå¾ `/kaggle/input/tmdb-box-office-prediction/`ï¼‰
- é€²è¡Œç‰¹å¾µå·¥ç¨‹
- è¨“ç·´å¤šå€‹æ¨¡å‹
- ç”Ÿæˆé æ¸¬çµæœï¼ˆå„²å­˜åˆ° `/kaggle/working/submission.csv`ï¼‰

### 4. æäº¤çµæœ

1. é»æ“Šå³ä¸Šè§’çš„ "Save Version"
2. é¸æ“‡ "Save & Run All"
3. ç­‰å¾…åŸ·è¡Œå®Œæˆ
4. åœ¨ Output ä¸­æ‰¾åˆ° `submission.csv`
5. é»æ“Š "Submit to Competition"

---

## ç¨‹å¼ç‰¹è‰²

### è‡ªå‹•æª¢æ¸¬å¯ç”¨å¥—ä»¶

ç¨‹å¼æœƒè‡ªå‹•æª¢æ¸¬ä»¥ä¸‹å¥—ä»¶æ˜¯å¦å¯ç”¨ï¼š
- âœ… **XGBoost**: é€šå¸¸åœ¨ Kaggle é è£
- âœ… **LightGBM**: é€šå¸¸åœ¨ Kaggle é è£
- âœ… **CatBoost**: é€šå¸¸åœ¨ Kaggle é è£

å¦‚æœæŸå€‹å¥—ä»¶ä¸å¯ç”¨ï¼Œç¨‹å¼æœƒè‡ªå‹•è·³éè©²æ¨¡å‹ã€‚

### å®Œæ•´çš„ç‰¹å¾µå·¥ç¨‹

ç¨‹å¼åŒ…å« **32 å€‹ç‰¹å¾µ**ï¼š

**åŸå§‹æ•¸å€¼ç‰¹å¾µ (3)**:
- budget, popularity, runtime

**æ™‚é–“ç‰¹å¾µ (5)**:
- release_year, release_month, release_quarter, release_day, release_dayofweek

**è¨ˆæ•¸ç‰¹å¾µ (7)**:
- genres_count, cast_count, crew_count, keywords_count
- production_companies_count, production_countries_count, spoken_languages_count

**å¸ƒæ—ç‰¹å¾µ (3)**:
- has_collection, has_homepage, has_tagline

**æ–‡æœ¬é•·åº¦ç‰¹å¾µ (4)**:
- title_length, overview_length, tagline_length, original_title_length

**è¡ç”Ÿç‰¹å¾µ (4)**:
- budget_popularity_ratio, budget_per_minute
- popularity_per_cast, budget_per_company

**å°æ•¸ç‰¹å¾µ (2)**:
- log_budget, log_popularity

**é¡åˆ¥ç‰¹å¾µ (3)**:
- original_language, status, top_genre

### å¤šæ¨¡å‹èåˆ

ç¨‹å¼æœƒè¨“ç·´ä»¥ä¸‹æ¨¡å‹ï¼ˆå¦‚æœå¯ç”¨ï¼‰ï¼š
1. **Random Forest** (200 trees, depth=20)
2. **XGBoost** (200 iterations, depth=8, lr=0.05)
3. **LightGBM** (200 iterations, depth=8, lr=0.05)
4. **CatBoost** (200 iterations, depth=8, lr=0.05)

æœ€å¾Œä½¿ç”¨ **Voting Ensemble** èåˆæ‰€æœ‰æ¨¡å‹çš„é æ¸¬ã€‚

---

## é æœŸæ€§èƒ½

### é©—è­‰é›†æ€§èƒ½

| æ¨¡å‹ | RMSE (é æœŸ) | RÂ² (é æœŸ) |
|------|-------------|-----------|
| Random Forest | ~$70-75M | ~0.68-0.72 |
| XGBoost | ~$65-70M | ~0.72-0.76 |
| LightGBM | ~$65-70M | ~0.72-0.76 |
| CatBoost | ~$65-70M | ~0.72-0.76 |
| **Voting Ensemble** | ~$60-65M | ~0.75-0.78 |

### Kaggle æ’è¡Œæ¦œ

- **Public Leaderboard**: é æœŸ RMSE ~$2.5-3.0M (log scale)
- **Private Leaderboard**: é æœŸé¡ä¼¼è¡¨ç¾

---

## é€²éšå„ªåŒ–å»ºè­°

### 1. è¶…åƒæ•¸èª¿å„ª

ä½¿ç”¨ GridSearchCV æˆ– RandomizedSearchCVï¼š

```python
from sklearn.model_selection import RandomizedSearchCV

param_dist = {
    'n_estimators': [100, 200, 300],
    'max_depth': [15, 20, 25],
    'min_samples_split': [2, 5, 10],
    'min_samples_leaf': [1, 2, 4]
}

rf_search = RandomizedSearchCV(
    RandomForestRegressor(random_state=42),
    param_dist,
    n_iter=20,
    cv=5,
    scoring='neg_root_mean_squared_error',
    n_jobs=-1
)
rf_search.fit(X_train, y_train)
```

### 2. ç‰¹å¾µé¸æ“‡

ä½¿ç”¨ç‰¹å¾µé‡è¦æ€§é€²è¡Œé¸æ“‡ï¼š

```python
# é¸æ“‡é‡è¦æ€§ > 0.01 çš„ç‰¹å¾µ
important_features = feature_importance[feature_importance['importance'] > 0.01]['feature'].tolist()
X_train_selected = X_train[important_features]
```

### 3. Stacking Ensemble

å¯¦ä½œæ›´é€²éšçš„ Stackingï¼š

```python
from sklearn.ensemble import StackingRegressor
from sklearn.linear_model import Ridge

stacking_model = StackingRegressor(
    estimators=[
        ('rf', rf_model),
        ('xgb', xgb_model),
        ('lgb', lgb_model)
    ],
    final_estimator=Ridge(),
    cv=5
)
stacking_model.fit(X_train, y_train)
```

### 4. ç›®æ¨™è®Šæ•¸è½‰æ›

å° revenue é€²è¡Œ log è½‰æ›ï¼š

```python
# è¨“ç·´æ™‚
y_train_log = np.log1p(y_train)
model.fit(X_train, y_train_log)

# é æ¸¬æ™‚
predictions_log = model.predict(X_test)
predictions = np.expm1(predictions_log)
```

### 5. å¤–éƒ¨è³‡æ–™

è€ƒæ…®åŠ å…¥ï¼š
- IMDb è©•åˆ†
- Rotten Tomatoes è©•åˆ†
- ç¤¾äº¤åª’é«”ç†±åº¦
- æ¼”å“¡/å°æ¼”çš„æ­·å²ç¥¨æˆ¿

---

## å¸¸è¦‹å•é¡Œ

### Q1: åŸ·è¡Œæ™‚é–“å¤ªé•·æ€éº¼è¾¦ï¼Ÿ

**A**: æ¸›å°‘æ¨¡å‹è¤‡é›œåº¦ï¼š
```python
# æ¸›å°‘æ¨¹çš„æ•¸é‡
n_estimators=100  # å¾ 200 æ”¹ç‚º 100

# æ¸›å°‘æ·±åº¦
max_depth=15  # å¾ 20 æ”¹ç‚º 15
```

### Q2: è¨˜æ†¶é«”ä¸è¶³æ€éº¼è¾¦ï¼Ÿ

**A**: 
1. æ¸›å°‘ç‰¹å¾µæ•¸é‡ï¼ˆåªä¿ç•™é‡è¦ç‰¹å¾µï¼‰
2. ä½¿ç”¨è¼ƒå°çš„é©—è­‰é›†æ¯”ä¾‹ï¼ˆtest_size=0.15ï¼‰
3. æ¸›å°‘æ¨¡å‹æ•¸é‡ï¼ˆåªä½¿ç”¨ RF + XGBoostï¼‰

### Q3: å¦‚ä½•æå‡æ’è¡Œæ¦œåˆ†æ•¸ï¼Ÿ

**A**: 
1. æ›´å¤šç‰¹å¾µå·¥ç¨‹ï¼ˆæ¼”å“¡/å°æ¼”ç‰¹å¾µï¼‰
2. è¶…åƒæ•¸èª¿å„ª
3. ä½¿ç”¨ Stacking è€Œé Voting
4. å°ç›®æ¨™è®Šæ•¸é€²è¡Œ log è½‰æ›
5. è™•ç†ç•°å¸¸å€¼

### Q4: ç‚ºä»€éº¼é©—è­‰é›† RÂ² å¾ˆé«˜ä½†æ’è¡Œæ¦œåˆ†æ•¸ä¸å¥½ï¼Ÿ

**A**: å¯èƒ½æ˜¯éæ“¬åˆï¼Œå»ºè­°ï¼š
1. å¢åŠ æ­£å‰‡åŒ–ï¼ˆé™ä½ max_depthï¼‰
2. ä½¿ç”¨äº¤å‰é©—è­‰
3. å¢åŠ è¨“ç·´è³‡æ–™
4. æ¸›å°‘ç‰¹å¾µæ•¸é‡

---

## æª”æ¡ˆçµæ§‹

```
kaggle-notebook/
â”œâ”€â”€ main-2.py              # Kaggle ç‰ˆæœ¬ä¸»ç¨‹å¼
â”œâ”€â”€ KAGGLE_GUIDE.md        # æœ¬æ–‡ä»¶
â””â”€â”€ submission.csv         # ç”Ÿæˆçš„é æ¸¬çµæœ
```

---

## ç‰ˆæœ¬æ­·å²

### v1.0 (main-2.py)
- âœ… å®Œæ•´çš„ç‰¹å¾µå·¥ç¨‹ï¼ˆ32 å€‹ç‰¹å¾µï¼‰
- âœ… å¤šæ¨¡å‹æ”¯æ´ï¼ˆRF, XGBoost, LightGBM, CatBoostï¼‰
- âœ… Voting Ensemble
- âœ… è‡ªå‹•æª¢æ¸¬å¯ç”¨å¥—ä»¶
- âœ… Kaggle è·¯å¾‘é©é…

---

## è¯çµ¡èˆ‡æ”¯æ´

å¦‚æœ‰å•é¡Œï¼Œè«‹åƒè€ƒï¼š
- [Kaggle Discussion](https://www.kaggle.com/competitions/tmdb-box-office-prediction/discussion)
- [å°ˆæ¡ˆ README](README.md)
- [å®Œæ•´å ±å‘Š](report.md)

---

**ç¥ä½ åœ¨ Kaggle ç«¶è³½ä¸­å–å¾—å¥½æˆç¸¾ï¼** ğŸ‰
