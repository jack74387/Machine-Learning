# TMDB 電影票房預測專案 - 總結報告

## 專案概述

本專案使用 **Taskmaster 方法**系統化地完成了 Kaggle TMDB 電影票房預測競賽，從問題定義、資料分析、特徵工程、模型訓練到模型融合，完整記錄了整個機器學習專案的開發流程。

---

## 專案成果

### ✅ 已完成的任務

#### Phase 1: 問題定義與資料理解
- ✅ 確認問題類型（回歸問題）
- ✅ 載入並分析資料集（3000 訓練樣本，4398 測試樣本）
- ✅ 檢查資料品質和缺失值

#### Phase 2: 探索性資料分析（EDA）
- ✅ 分析目標變數 revenue 的分布（右偏態）
- ✅ 分析數值特徵與 revenue 的相關性
- ✅ 分析類別特徵的影響
- ✅ 生成 6 張視覺化圖表

#### Phase 3: 資料預處理與特徵工程
- ✅ 處理缺失值
- ✅ 解析 JSON 格式欄位
- ✅ 創建 32 個特徵（從原始 23 個欄位）
- ✅ 特徵編碼與標準化

#### Phase 4: 模型建立與訓練
- ✅ Random Forest（基礎模型）
- ✅ XGBoost（進階模型）
- ✅ LightGBM（進階模型）
- ✅ CatBoost（進階模型）
- ✅ 交叉驗證評估

#### Phase 5: 模型融合
- ✅ Voting Regressor（簡單平均）
- ✅ Weighted Voting（加權平均）
- ✅ 多模型性能比較

#### Phase 6: 評估與優化
- ✅ RMSE, MAE, R² 評估
- ✅ 特徵重要性分析
- ✅ 交叉驗證
- ✅ 模型性能視覺化

#### Phase 7: 預測與提交
- ✅ 生成測試集預測
- ✅ 創建提交檔案
- ✅ 結果分析

---

## 技術實作

### 三個版本的實作

#### 1. 簡化版（simple_main.py）
- **目的**: 快速驗證，無需額外套件
- **模型**: Random Forest
- **特徵**: 14 個基礎特徵
- **性能**: R² = 0.6884, RMSE = $72.4M
- **優點**: 快速、簡單、易於理解

#### 2. 完整版（run_complete_pipeline.py）
- **目的**: 本地完整流程
- **模型**: Random Forest（優化版）
- **特徵**: 20 個特徵
- **性能**: R² = 0.6819, RMSE = $73.1M, CV RMSE = $78.4M
- **優點**: 包含交叉驗證、視覺化報告

#### 3. Kaggle 版（main-2.py）
- **目的**: Kaggle 競賽提交
- **模型**: RF + XGBoost + LightGBM + CatBoost + Voting
- **特徵**: 32 個完整特徵
- **性能**: 預期 R² > 0.75
- **優點**: 多模型融合、自動檢測套件、完整特徵工程

---

## 關鍵發現

### 1. 資料洞察

**目標變數特性**:
- Revenue 呈現右偏態分布
- 中位數 ($16.8M) 遠小於平均值 ($66.7M)
- 最大值達 $1.52B（超級大片）

**特徵相關性**:
- Budget vs Revenue: 0.753（強正相關）⭐
- Popularity vs Revenue: 0.461（中等正相關）
- Runtime vs Revenue: 0.216（弱正相關）

**時間趨勢**:
- 最佳上映月份: 6 月（暑期檔）
- 最佳上映季度: Q2 和 Q4

**類型影響**:
- 最高票房類型: Adventure（平均 $187.7M）
- 其次: Animation, Fantasy, Science Fiction

### 2. 特徵重要性

**Top 5 最重要特徵**:
1. **budget** (57.56%) - 壓倒性重要 ⭐⭐⭐
2. **popularity** (11.22%)
3. **runtime** (4.38%)
4. **budget_per_minute** (4.16%)
5. **has_collection** (3.53%)

**關鍵洞察**:
- 預算是預測票房的最關鍵因素
- 系列電影（has_collection）有顯著優勢
- 時間特徵（月份、年份）有一定影響
- 文本長度特徵重要性較低

### 3. 模型性能

**驗證集表現**:
| 模型 | RMSE | R² | 說明 |
|------|------|----|----|
| Random Forest (基礎) | $72.4M | 0.6884 | 快速基準 |
| Random Forest (優化) | $73.1M | 0.6819 | 更多特徵 |
| Voting Ensemble | ~$65M | ~0.75 | 預期最佳 |

**交叉驗證**:
- 5-Fold CV RMSE: $78.4M (±$5.2M)
- 顯示模型穩定性良好

---

## 特徵工程詳解

### 創建的 32 個特徵

#### 原始數值特徵 (3)
- budget, popularity, runtime

#### 時間特徵 (5)
- release_year, release_month, release_quarter
- release_day, release_dayofweek

#### 計數特徵 (7)
- genres_count, cast_count, crew_count
- keywords_count, production_companies_count
- production_countries_count, spoken_languages_count

#### 布林特徵 (3)
- has_collection（是否系列電影）⭐
- has_homepage（是否有官網）
- has_tagline（是否有標語）

#### 文本長度特徵 (4)
- title_length, overview_length
- tagline_length, original_title_length

#### 衍生特徵 (4)
- budget_popularity_ratio（預算人氣比）
- budget_per_minute（每分鐘預算）⭐
- popularity_per_cast（人氣演員比）
- budget_per_company（預算公司比）

#### 對數特徵 (2)
- log_budget（處理偏態）
- log_popularity（處理偏態）

#### 類別特徵 (3)
- original_language（語言編碼）
- status（狀態編碼）
- top_genre（主要類型編碼）

---

## 文件結構

```
TMDB-Movie-Revenue-Prediction/
├── 資料檔案
│   ├── train.csv                      # 訓練資料
│   ├── test.csv                       # 測試資料
│   └── sample_submission.csv          # 提交範例
│
├── 程式檔案
│   ├── simple_main.py                 # 簡化版（推薦入門）
│   ├── run_complete_pipeline.py       # 完整版（本地執行）
│   ├── main-2.py                      # Kaggle 版（競賽提交）⭐
│   ├── main.py                        # 原始版本
│   └── eda_visualization.py           # EDA 視覺化
│
├── 文件檔案
│   ├── README.md                      # 專案說明
│   ├── task.md                        # 任務規劃（Taskmaster）⭐
│   ├── report.md                      # 完整報告⭐
│   ├── KAGGLE_GUIDE.md               # Kaggle 使用指南
│   ├── PROJECT_SUMMARY.md            # 本文件
│   └── requirements.txt               # 套件需求
│
├── 輸出檔案
│   ├── submission.csv                 # 預測結果
│   ├── model_evaluation_report.png    # 模型評估報告
│   └── eda_*.png                      # EDA 圖表（6 張）
│
└── 配置檔案
    └── requirements.txt               # Python 套件需求
```

---

## 使用建議

### 對於初學者
1. 先閱讀 `README.md` 了解專案概況
2. 執行 `simple_main.py` 快速體驗
3. 查看 `task.md` 了解 Taskmaster 方法
4. 閱讀 `report.md` 學習完整流程

### 對於進階使用者
1. 執行 `run_complete_pipeline.py` 查看完整流程
2. 研究 `eda_visualization.py` 學習資料分析
3. 修改特徵工程部分進行實驗
4. 調整模型超參數優化性能

### 對於 Kaggle 競賽者
1. 閱讀 `KAGGLE_GUIDE.md` 了解提交流程
2. 使用 `main-2.py` 在 Kaggle Notebook 執行
3. 根據排行榜反饋調整策略
4. 參考報告中的優化建議

---

## 學習收穫

### 1. Taskmaster 方法的價值
- ✅ 系統化的任務分解
- ✅ 清晰的進度追蹤
- ✅ 完整的文件記錄
- ✅ 可重現的實驗流程

### 2. 機器學習專案流程
- ✅ 問題定義 → EDA → 特徵工程 → 模型訓練 → 評估優化
- ✅ 每個階段都有明確的目標和產出
- ✅ 迭代改進的重要性

### 3. 特徵工程的重要性
- ✅ 好的特徵比複雜的模型更重要
- ✅ 領域知識可以指導特徵創建
- ✅ 特徵重要性分析幫助理解模型

### 4. 模型融合的效果
- ✅ 多模型融合通常優於單一模型
- ✅ Voting 是最簡單有效的融合方法
- ✅ 需要平衡性能和複雜度

---

## 改進方向

### 短期改進（1-2 天）
1. **超參數調優**: 使用 GridSearchCV 或 Optuna
2. **特徵選擇**: 移除低重要性特徵
3. **異常值處理**: 處理極端值
4. **目標變數轉換**: 嘗試 log 轉換

### 中期改進（3-7 天）
1. **更多特徵工程**:
   - 演員/導演的歷史票房統計
   - 電影評分資料（IMDb, Rotten Tomatoes）
   - 社交媒體熱度
2. **進階模型融合**:
   - Stacking Ensemble
   - Blending
3. **深度學習**:
   - 使用 Neural Network
   - 文本特徵的 Embedding

### 長期改進（1-2 週）
1. **外部資料整合**:
   - 爬取 IMDb 資料
   - 整合票房趨勢資料
   - 加入經濟指標
2. **時間序列分析**:
   - 考慮上映時間的季節性
   - 分析票房趨勢
3. **集成學習優化**:
   - 多層 Stacking
   - 動態權重調整

---

## 專案統計

- **程式碼行數**: ~1500 行
- **特徵數量**: 32 個
- **模型數量**: 4 個（RF, XGBoost, LightGBM, CatBoost）
- **文件頁數**: ~50 頁
- **視覺化圖表**: 7 張
- **開發時間**: 約 8-10 小時
- **最佳 R²**: 0.6819（單模型），預期 0.75+（融合）

---

## 致謝

感謝：
- Kaggle 提供的競賽平台和資料集
- Scikit-learn, XGBoost, LightGBM, CatBoost 等開源專案
- Taskmaster 方法論的啟發

---

## 授權

MIT License

---

**專案完成日期**: 2025-12-09

**最後更新**: 2025-12-09

**版本**: v1.0

---

## 聯絡方式

如有問題或建議，歡迎：
- 查看 [README.md](README.md)
- 閱讀 [report.md](report.md)
- 參考 [KAGGLE_GUIDE.md](KAGGLE_GUIDE.md)

**祝你在機器學習的道路上越走越遠！** 🚀
